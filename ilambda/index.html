<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="[Shane Mulligan]">
<meta name="description" content="ùëñŒª (Imaginary Programming Functions) Summary tl;dr: Imaginary Programming (IP) is where data and knowledge has been substituted for inference by a LM. Therefore, the implementation of an ùëñŒª library will be uniquely tailored to each language.
I design and build an IP library named ùëñŒª.el for emacs. Think of it a bit like a functional programming library in that you will find a set of functions and macros for working in the programming paradigm." />
<meta name="keywords" content="NLP GPT OpenAI EleutherAI Huggingface AGI" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://semiosis.github.io/ilambda/" />


    <title>
        
            ùëñŒª, a family of imaginary programming libraries :: semiosis  ‚Äî Signs, Natural Language and Coding
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.24c99ccdbff87283240b25bb2ed32ca911508e3c7b3dd475be949eb12fa1c053.css">






<meta itemprop="name" content="ùëñŒª, a family of imaginary programming libraries">
<meta itemprop="description" content="ùëñŒª (Imaginary Programming Functions) Summary tl;dr: Imaginary Programming (IP) is where data and knowledge has been substituted for inference by a LM. Therefore, the implementation of an ùëñŒª library will be uniquely tailored to each language.
I design and build an IP library named ùëñŒª.el for emacs. Think of it a bit like a functional programming library in that you will find a set of functions and macros for working in the programming paradigm."><meta itemprop="datePublished" content="2021-09-03T00:00:00&#43;12:00" />
<meta itemprop="dateModified" content="2021-09-03T00:00:00&#43;12:00" />
<meta itemprop="wordCount" content="2202"><meta itemprop="image" content="http://semiosis.github.io/"/>
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="http://semiosis.github.io/"/>

<meta name="twitter:title" content="ùëñŒª, a family of imaginary programming libraries"/>
<meta name="twitter:description" content="ùëñŒª (Imaginary Programming Functions) Summary tl;dr: Imaginary Programming (IP) is where data and knowledge has been substituted for inference by a LM. Therefore, the implementation of an ùëñŒª library will be uniquely tailored to each language.
I design and build an IP library named ùëñŒª.el for emacs. Think of it a bit like a functional programming library in that you will find a set of functions and macros for working in the programming paradigm."/>




    <meta property="og:title" content="ùëñŒª, a family of imaginary programming libraries" />
<meta property="og:description" content="ùëñŒª (Imaginary Programming Functions) Summary tl;dr: Imaginary Programming (IP) is where data and knowledge has been substituted for inference by a LM. Therefore, the implementation of an ùëñŒª library will be uniquely tailored to each language.
I design and build an IP library named ùëñŒª.el for emacs. Think of it a bit like a functional programming library in that you will find a set of functions and macros for working in the programming paradigm." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://semiosis.github.io/ilambda/" /><meta property="og:image" content="http://semiosis.github.io/"/><meta property="article:section" content="" />
<meta property="article:published_time" content="2021-09-03T00:00:00&#43;12:00" />
<meta property="article:modified_time" content="2021-09-03T00:00:00&#43;12:00" /><meta property="og:site_name" content="semiosis" />







    <meta property="article:published_time" content="2021-09-03 00:00:00 &#43;1200 NZST" />









<script type="text/javascript">
 var _paq = window._paq = window._paq || [];
  
 _paq.push(['trackPageView']);
 _paq.push(['enableLinkTracking']);
 (function() {
     var u="https://mullikine.matomo.cloud/";
     _paq.push(['setTrackerUrl', u+'matomo.php']);
     _paq.push(['setSiteId', '2']);
     var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
     g.type='text/javascript'; g.async=true; g.src='//cdn.matomo.cloud/mullikine.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
 })();
</script>

    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">semiosis</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/posts/">Blog</a></li><li><a href="/examplary/">Examplary</a></li><li><a href="/ii/">Imaginary Interpreter</a></li><li><a href="/ink/">Ink.el</a></li><li><a href="/pen/">Pen.el</a></li><li><a href="/philosophy/">PHIL</a></li><li><a href="/ilambda/">ùëñŒª</a></li><li><a href="/looking-glass/">üîç</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://semiosis.github.io/ilambda/">ùëñŒª, a family of imaginary programming libraries</a></h2>

            
            
            

            <div class="post-content">
                <h2 id="ùëñŒª--imaginary-programming-functions"><code>ùëñŒª</code> (Imaginary Programming Functions)</h2>
<h3 id="summary">Summary</h3>
<p><span class="underline">tl;dr:</span> Imaginary Programming (<code>IP</code>) is where
data and knowledge has been substituted for
inference by a LM. Therefore, the
implementation of an <code>ùëñŒª</code> library will be
uniquely tailored to each language.</p>
<p>I design and build an <code>IP</code> library named
<code>ùëñŒª.el</code> for emacs. Think of it a bit like a
functional programming library in that you
will find a set of functions and macros for
working in the programming paradigm. The
objective here is to create some functions for
doing IP in emacs lisp, since emacs lisp has
the expressive power to prototype such things,
but the ideas contained here can easily be
transferred to any other programming language.
The results of this little experiment will
straight into my thesis.</p>
<dl>
<dt>ùëñŒª project</dt>
<dd><a href="http://github.com/semiosis/ilambda/">http://github.com/semiosis/ilambda/</a></dd>
<dt>IP thesis</dt>
<dd><a href="https://github.com/semiosis/imaginary-programming-thesis/blob/master/thesis.org">https://github.com/semiosis/imaginary-programming-thesis/blob/master/thesis.org</a></dd>
<dt>IP library</dt>
<dd><a href="http://github.com/semiosis/pen.el/blob/master/src/ilambda.el">http://github.com/semiosis/pen.el/blob/master/src/ilambda.el</a></dd>
<dt>IP glossary</dt>
<dd><a href="https://github.com/semiosis/glossaries-gh/blob/master/imaginary-programming.txt">https://github.com/semiosis/glossaries-gh/blob/master/imaginary-programming.txt</a></dd>
</dl>
<p><code>imacro</code> (like regular macros) are for
generating code. <code>idefun</code>, however, doesnt
generate the code but attempts to evaluate a
function <em>without</em> code, or <strong>if</strong> code is supplied
then <em>imagine</em> evaluating that code rather than
actually evaluating it.</p>
<p>It&rsquo;s kinda crazy that <code>Im</code>-macros run faster
and are more reliable than <code>Im</code>-functions,
where the opposite is true in regular
programming. That&rsquo;s because they generate the
code which can be <span class="underline">reused</span>, adjusted and
interactively regenerated, where an
<code>Im</code>-function will typically have to query the
LM every time you call it.</p>
<h4 id="the-objective-with-ùëñŒª-dot-el">The objective with <code>ùëñŒª.el</code></h4>
<p>The objective here is to create <code>IP</code> functions
for programming in emacs lisp exclusively.</p>
<p>It will be extended in the future to do all
programming languages, but I intend to make
<code>ùëñŒª.el</code> simple and effective for programming
in emacs lisp without bloat or over-complication.</p>
<h3 id="syntax-forms">Syntax forms</h3>
<table>
<thead>
<tr>
<th>name</th>
<th>type</th>
<th>depends on</th>
<th>basic idea</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ieval</code></td>
<td>MACRO</td>
<td></td>
<td><code>ieval</code> will imagine the evaluation of some code without any other context.</td>
</tr>
<tr>
<td><code>imacro/N</code></td>
<td>MACRO</td>
<td></td>
<td><code>imacro</code> does not evaluate. It merely generates code, but that code is imagined. Like <code>idefun</code> it is variadic.</td>
</tr>
<tr>
<td><code>idefun</code></td>
<td>FUNCTION</td>
<td><code>ieval</code> and <code>imacro</code></td>
<td>Run an imagined function on the given arguments and return an imagined result, but create a binding for the function.</td>
</tr>
<tr>
<td><code>ilist</code></td>
<td>FUNCTION</td>
<td></td>
<td>Generate a list of things. Return a real list.</td>
</tr>
<tr>
<td><code>ilambda</code> / <code>ùëñŒª</code></td>
<td>FUNCTION</td>
<td><code>ieval</code></td>
<td>Imaginarily run an expression on the given arguments and return an imagined result.</td>
</tr>
<tr>
<td><code>ifilter</code></td>
<td>FUNCTION</td>
<td></td>
<td>Imaginarily filter a real list with natural language and return a real list. Optionally, enforce cardinality.</td>
</tr>
<tr>
<td><code>iparse</code></td>
<td>MACRO</td>
<td></td>
<td>Given a syntax form / expression, will parse a syntax form with natural language. Returns the subform.</td>
</tr>
<tr>
<td><code>defimacro</code></td>
<td>MACRO</td>
<td><code>imacro/N</code></td>
<td>Select the appropriate <code>imacro/N</code> form depending on the arity of arguments.</td>
</tr>
</tbody>
</table>
<h4 id="ieval"><code>ieval</code></h4>
<p><code>ieval</code> will simply evaluate the provided
string/sexp as emacs lisp code. You
must provide <code>ieval</code> with, firstly, the preceding
code, which may be, for example, a function
definition or package requires, etc. and,
secondly, evaluated expression. Either
argument can either be a raw string containing
code or a sexp, but the expression will be
&ldquo;one-line-ized&rdquo; for the prompt.</p>
<p><code>ieval</code> is used by <code>idefun</code> and <code>ilambda</code>.</p>
<p><span class="underline"><em>prompt function</em></span> for running the eval.</p>
<dl>
<dt><code>pf-imagine-evaluating-emacs-lisp/2</code></dt>
<dd><a href="http://github.com/semiosis/prompts/blob/master/prompts/imagine-evaluating-emacs-lisp-2.prompt">http://github.com/semiosis/prompts/blob/master/prompts/imagine-evaluating-emacs-lisp-2.prompt</a></dd>
</dl>
<!--listend-->
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">task</span>: <span style="color:#e6db74">&#34;imagine evaluating emacs lisp&#34;</span>
<span style="color:#f92672">doc</span>: <span style="color:#e6db74">&#34;Given some elisp return the imagined result&#34;</span>
<span style="color:#f92672">prompt-version</span>: <span style="color:#ae81ff">1</span>
<span style="color:#f92672">prompt</span>: |+<span style="color:#e6db74">
</span><span style="color:#e6db74">  &lt;code&gt;
</span><span style="color:#e6db74">  (message (eval &lt;expression&gt;))
</span><span style="color:#e6db74">  --&gt;</span>  
<span style="color:#f92672">engine</span>: <span style="color:#e6db74">&#34;OpenAI Codex&#34;</span>
<span style="color:#f92672">temperature</span>: <span style="color:#ae81ff">0.2</span>
<span style="color:#f92672">max-generated-tokens</span>: <span style="color:#ae81ff">60</span>
<span style="color:#f92672">top-p</span>: <span style="color:#ae81ff">1.0</span>
<span style="color:#f92672">cache</span>: <span style="color:#66d9ef">on</span>
<span style="color:#f92672">stop-sequences</span>:
- <span style="color:#e6db74">&#34;\n&#34;</span>
<span style="color:#f92672">vars</span>:
- <span style="color:#e6db74">&#34;code&#34;</span>
- <span style="color:#e6db74">&#34;expression&#34;</span>
<span style="color:#f92672">validator</span>: <span style="color:#e6db74">&#34;grep -qv &#39;(:return&#39;&#34;</span>
<span style="color:#f92672">examples</span>:
- |-<span style="color:#e6db74">
</span><span style="color:#e6db74">    (defun double-number (x)
</span><span style="color:#e6db74">      (x * x))</span>    
- <span style="color:#e6db74">&#34;(double-number 5)&#34;</span>
<span style="color:#f92672">filter</span>: <span style="color:#66d9ef">on</span>
<span style="color:#f92672">completion</span>: <span style="color:#66d9ef">off</span>
<span style="color:#f92672">insertion</span>: <span style="color:#66d9ef">off</span></code></pre></td></tr></table>
</div>
</div>
<p>The following is the implementation of <code>ieval</code>.</p>
<p>You may pass either a <code>sexp</code> or a raw string containing code.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defmacro ieval (expression <span style="color:#66d9ef">&amp;optional</span> code)
  <span style="color:#e6db74">&#34;Imaginarily evaluate the expression, given the code and return a real result.&#34;</span>
  (let* ((code-str
          (cond
           ((<span style="color:#a6e22e">stringp</span> code) code)
           ((<span style="color:#a6e22e">listp</span> code) (pps code))))
         (expression-str
          (cond
           ((<span style="color:#a6e22e">stringp</span> expression) expression)
           ((<span style="color:#a6e22e">listp</span> expression) (pp-oneline expression))))
         (result (<span style="color:#a6e22e">car</span>
                  (pen-single-generation
                   (pf-imagine-evaluating-emacs-lisp/2
                    code-str expression-str
                    :no-select-result <span style="color:#66d9ef">t</span> :select-only-match <span style="color:#66d9ef">t</span>)))))
    (ignore-errors
      (eval-string result))))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defun test-ieval-2 ()
  (ieval
   (double-number <span style="color:#ae81ff">5</span>)
   <span style="color:#e6db74">&#34;(defun double-number (x)\n     (x * x))\n;;Test the double-number function&#34;</span>))</code></pre></td></tr></table>
</div>
</div>
<p>Resulting prompt from <code>test-ieval-2</code>:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">(defun double-number (x)
     (x * x))
;;Test the double-number function
(message (eval (double-number 5)))
--&gt; &lt;END&gt;</code></pre></td></tr></table>
</div>
</div>
<p><code>ieval</code> not only evaluates correctly despite
the deliberately incorrect naming of the
function (it multiplies rather than doubles),
but it returns the value as the correct data type.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defun test-ieval ()
  (ieval
   (double-number <span style="color:#ae81ff">5</span>)
   (defun double-number (x)
     (x <span style="color:#a6e22e">*</span> x))))</code></pre></td></tr></table>
</div>
</div>
<p>Expansion of <code>test-ieval</code>.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(let ((result
       (ieval
        (defun double-number (x)
          (x <span style="color:#a6e22e">*</span> x))
        (double-number <span style="color:#ae81ff">5</span>))))
  (list2str (<span style="color:#a6e22e">list</span> result
                  (type result))))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">25
integer</code></pre></td></tr></table>
</div>
</div>
<h4 id="ilambda-ùëñŒª"><code>ilambda</code> / <code>ùëñŒª</code></h4>
<p>Imaginarily run an expression on the given
arguments and return an imagined result.</p>
<p>Here are three <code>ilambda</code> subforms which take different arguments.</p>
<p><code>ilambda/task</code> is the most terse. Only a NL
task description is given.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defmacro ilambda/task (args task <span style="color:#66d9ef">&amp;optional</span> name-sym)
  (let* ((slug (s-replace-regexp <span style="color:#e6db74">&#34;-$&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> (slugify (<span style="color:#a6e22e">eval</span> task))))
         (fsym (or name-sym
                   (<span style="color:#a6e22e">intern</span> slug))))
    <span style="color:#f92672">`</span>(lambda <span style="color:#f92672">,</span>args
       (<span style="color:#a6e22e">eval</span>
        <span style="color:#75715e">;; imagined by an LM</span>
        <span style="color:#f92672">`</span>(ieval
          <span style="color:#75715e">;; An function and a function call</span>
          (<span style="color:#f92672">,</span><span style="color:#e6db74">&#39;,fsym</span> <span style="color:#f92672">,,@</span>args)
          <span style="color:#f92672">,,</span>(<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34;;; &#34;</span> task))))))
(defalias <span style="color:#e6db74">&#39;ùëñŒª/task</span> <span style="color:#e6db74">&#39;ilambda/task</span>)

(defmacro ilambda/task-code (args task code <span style="color:#66d9ef">&amp;optional</span> name-sym)
  (let* ((slug (s-replace-regexp <span style="color:#e6db74">&#34;-$&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> (slugify (<span style="color:#a6e22e">eval</span> task))))
         (fsym (or
                name-sym
                (<span style="color:#a6e22e">intern</span> slug))))
    <span style="color:#f92672">`</span>(lambda <span style="color:#f92672">,</span>args
       (<span style="color:#a6e22e">eval</span>
        <span style="color:#75715e">;; imagined by an LM</span>
        <span style="color:#f92672">`</span>(ieval
          <span style="color:#75715e">;; An function and a function call</span>
          (<span style="color:#f92672">,</span><span style="color:#e6db74">&#39;,fsym</span> <span style="color:#f92672">,,@</span>args)
          (defun <span style="color:#f92672">,</span><span style="color:#e6db74">&#39;,fsym</span> <span style="color:#f92672">,</span><span style="color:#e6db74">&#39;,args</span>
            <span style="color:#f92672">,,</span>task
            <span style="color:#f92672">,</span><span style="color:#e6db74">&#39;,code</span>))))))
(defalias <span style="color:#e6db74">&#39;ùëñŒª/task-code</span> <span style="color:#e6db74">&#39;ilambda/task-code</span>)

(defmacro ilambda/code (args code <span style="color:#66d9ef">&amp;optional</span> name-sym)
  (let ((fsym (or name-sym
                  <span style="color:#e6db74">&#39;main</span>)))
    <span style="color:#f92672">`</span>(lambda <span style="color:#f92672">,</span>args
       (<span style="color:#a6e22e">eval</span>
        <span style="color:#75715e">;; imagined by an LM</span>
        <span style="color:#f92672">`</span>(ieval
          <span style="color:#75715e">;; An function and a function call</span>
          (<span style="color:#f92672">,</span><span style="color:#e6db74">&#39;,fsym</span> <span style="color:#f92672">,,@</span>args)
          (defun <span style="color:#f92672">,</span><span style="color:#e6db74">&#39;,fsym</span> (<span style="color:#f92672">,</span><span style="color:#e6db74">&#39;,@args</span>)
            <span style="color:#f92672">,</span><span style="color:#e6db74">&#39;,code</span>))))))
(defalias <span style="color:#e6db74">&#39;ùëñŒª/code</span> <span style="color:#e6db74">&#39;ilambda/code</span>)</code></pre></td></tr></table>
</div>
</div>
<p><em><strong>Demonstrations</strong></em></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(<span style="color:#a6e22e">mapcar</span> (ilambda/task (x) <span style="color:#e6db74">&#34;double it&#34;</span>)
        <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">12</span> <span style="color:#ae81ff">4</span>))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="color:#e6db74">&#34;(24 8)
</span><span style="color:#e6db74">&#34;</span>
</code></pre></div><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(<span style="color:#a6e22e">mapcar</span> (ilambda/code (x)
                      (<span style="color:#a6e22e">+</span> x <span style="color:#ae81ff">5</span>))
        <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">4</span>))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="color:#e6db74">&#34;(9)
</span><span style="color:#e6db74">&#34;</span>
</code></pre></div><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(<span style="color:#a6e22e">mapcar</span> (ilambda/task-code (x)
                           <span style="color:#e6db74">&#34;add five&#34;</span>
                           (<span style="color:#a6e22e">+</span> x <span style="color:#ae81ff">5</span>))
        <span style="color:#f92672">&#39;</span>(<span style="color:#ae81ff">8</span>))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="color:#e6db74">&#34;(13)
</span><span style="color:#e6db74">&#34;</span>
</code></pre></div><p>The <em><strong>ilambda</strong></em> macro.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defmacro ilambda (args code-or-task <span style="color:#66d9ef">&amp;optional</span> task-or-code name-sym)
  <span style="color:#e6db74">&#34;Define an imaginary lambda (ùëñŒª)&#34;</span>
  (let ((task (if (<span style="color:#a6e22e">stringp</span> code-or-task)
                  code-or-task
                task-or-code))
        (code (if (<span style="color:#a6e22e">listp</span> code-or-task)
                  code-or-task
                task-or-code)))
    (cond
     ((and code
           (sor task))
      <span style="color:#f92672">`</span>(ilambda/task-code <span style="color:#f92672">,</span>args <span style="color:#f92672">,</span>task <span style="color:#f92672">,</span>code <span style="color:#f92672">,</span>name-sym))
     ((sor task)
      <span style="color:#f92672">`</span>(ilambda/task <span style="color:#f92672">,</span>args <span style="color:#f92672">,</span>task <span style="color:#f92672">,</span>name-sym))
     ((<span style="color:#a6e22e">listp</span> code-or-task)
      <span style="color:#f92672">`</span>(ilambda/code <span style="color:#f92672">,</span>args <span style="color:#f92672">,</span>code <span style="color:#f92672">,</span>name-sym)))))

(defalias <span style="color:#e6db74">&#39;ùëñŒª</span> <span style="color:#e6db74">&#39;ilambda</span>)</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(-reduce (ùëñŒª (x y) <span style="color:#e6db74">&#34;add x to y&#34;</span>) (number-sequence <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span>))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="color:#e6db74">&#34;6&#34;</span>
</code></pre></div><h4 id="idefun"><code>idefun</code></h4>
<p>The <code>idefun</code> creates a binding to an imaginary
function. The implementation of the <code>idefun</code>
need not be specified in order for code to
run.</p>
<p>The new prompt function returned by <code>idefun</code> is provided with arguments and the
values of those arguments are taken and placed
into a prompt. An implementation may be
provided to <code>idefun</code> when defining the prompt function or optionally left out.
Unlike an <code>imacro</code>, when the prompt function
is evaluated the code is not returned. Rather,
the code is evaluted in imaginary space.</p>
<p>In short, the LM will imagine the evaluation
of the function as opposed to generate code.</p>
<p><code>idefun</code> returns a binding to a new prompt
function.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(idefun generate-fib-sequence (n))

(pp-to-string (generate-fib-sequence <span style="color:#ae81ff">5</span>))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(<span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">5</span>)</code></pre></td></tr></table>
</div>
</div>
<p>With a temperature of <code>0.0</code>, this will hash to
the same thing every time!</p>
<p>Strangely, we can&rsquo;t call it a &lsquo;neural hash&rsquo; though.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(idefun sha-hash-string (s))

(pen-force
 ((temperature <span style="color:#ae81ff">0.0</span>))
 (sha-hash-string <span style="color:#e6db74">&#34;sugar shane&#34;</span>))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">f1d3ff8ec24e91b957c9e55adec407f47b55e3ae</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(idefun neural-hash-string (s)
  <span style="color:#e6db74">&#34;This calculates a neural hash of the string.&#34;</span>)

(pen-force
 ((temperature <span style="color:#ae81ff">0.0</span>))
 (neural-hash-string <span style="color:#e6db74">&#34;sugar shane&#34;</span>))</code></pre></td></tr></table>
</div>
</div>
<p>&ldquo;0x7f8b8f8e&rdquo;</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defmacro idefun (name-sym args <span style="color:#66d9ef">&amp;optional</span> code-or-task task-or-code)
  <span style="color:#e6db74">&#34;Define an imaginary function&#34;</span>
  (cond
   ((and (<span style="color:#a6e22e">stringp</span> name-sym)
         (not code-or-task))
    (progn
      (setq code-or-task name-sym)
      (setq name-sym (<span style="color:#a6e22e">intern</span> (s-replace-regexp <span style="color:#e6db74">&#34;-$&#34;</span> <span style="color:#e6db74">&#34;&#34;</span> (slugify (str name-sym)))))))
   ((and (<span style="color:#a6e22e">symbolp</span> name-sym)
         (not code-or-task))
    (setq code-or-task (pen-snc <span style="color:#e6db74">&#34;unsnakecase&#34;</span> (sym2str name-sym)))))
  <span style="color:#f92672">`</span>(defalias <span style="color:#e6db74">&#39;,name-sym</span>
     (function <span style="color:#f92672">,</span>(<span style="color:#a6e22e">eval</span>
                 <span style="color:#f92672">`</span>(ilambda <span style="color:#f92672">,</span>args <span style="color:#f92672">,</span>code-or-task <span style="color:#f92672">,</span>task-or-code <span style="color:#f92672">,</span>name-sym)))))

(idefun idoubleit (x)
        <span style="color:#e6db74">&#34;double it&#34;</span>)</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(idoubleit <span style="color:#ae81ff">5</span>)</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="color:#e6db74">&#34;10&#34;</span>
</code></pre></div><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(idefun distance-between-planets (x y)
        <span style="color:#e6db74">&#34;distance between planets in astronomical units (AU)&#34;</span>)

(<span style="color:#a6e22e">concat</span> (str (distance-between-planets <span style="color:#e6db74">&#34;saturn&#34;</span> <span style="color:#e6db74">&#34;jupiter&#34;</span>))
        <span style="color:#e6db74">&#34;\n&#34;</span>
        (str (distance-between-planets <span style="color:#e6db74">&#34;mercury&#34;</span> <span style="color:#e6db74">&#34;jupiter&#34;</span>)))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="color:#e6db74">&#34;\&#34;0.05\\n0.387\&#34;&#34;</span>
</code></pre></div><p>I have no idea if this data is correct but it
seems consistent with itself.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(idefun distance-between-planets (x y)
        <span style="color:#e6db74">&#34;distance between planets in million miles&#34;</span>)

(<span style="color:#a6e22e">concat</span> (str (distance-between-planets <span style="color:#e6db74">&#34;saturn&#34;</span> <span style="color:#e6db74">&#34;jupiter&#34;</span>))
        <span style="color:#e6db74">&#34;\n&#34;</span>
        (str (distance-between-planets <span style="color:#e6db74">&#34;mercury&#34;</span> <span style="color:#e6db74">&#34;jupiter&#34;</span>)))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="color:#e6db74">&#34;\&#34;1.2\\n5.791\&#34;&#34;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">&#34;1.2\n5.791&#34;
</code></pre></div><p>Sadly, Codex doesn&rsquo;t know too much about Scoville food hotness.</p>
<table>
<thead>
<tr>
<th>food</th>
<th>Scoville scale</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pure capsaicin</td>
<td>16,000,000 SHU</td>
</tr>
<tr>
<td>Jalape√±o</td>
<td>10,000 SHU</td>
</tr>
</tbody>
</table>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(idefun scoville-difference (food-a food-b)
        <span style="color:#e6db74">&#34;difference between two foods in scoville Heat Units (SHUs)&#34;</span>)

(<span style="color:#a6e22e">concat</span> (str (scoville-difference <span style="color:#e6db74">&#34;Pure capsaicin&#34;</span> <span style="color:#e6db74">&#34;Jalape√±o&#34;</span>))
        <span style="color:#e6db74">&#34;\n&#34;</span>
        (str (scoville-difference <span style="color:#e6db74">&#34;Chipotle&#34;</span> <span style="color:#e6db74">&#34;Trinidad Scorpion Butch&#34;</span>)))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="color:#e6db74">&#34;\&#34;0\\n2\&#34;&#34;</span>
</code></pre></div><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(idefun hex-for-colour (colour))

(hex-for-colour <span style="color:#e6db74">&#34;watermelon&#34;</span>)</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="color:#e6db74">&#34;\&#34;0x6f3d9c\&#34;&#34;</span>
</code></pre></div><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(idefun hex-for-colour (colour))

(hex-for-colour <span style="color:#e6db74">&#34;snow&#34;</span>)</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp"><span style="color:#e6db74">&#34;\&#34;ffffff\&#34;&#34;</span>
</code></pre></div><p><em><strong>Demo</strong></em></p>
<!-- Play on asciinema.com -->
<!-- <a title="asciinema recording" href="https://asciinema.org/a/flwFZOaUnv6UtiLcpqFYkgsop" target="_blank"><img alt="asciinema recording" src="https://asciinema.org/a/flwFZOaUnv6UtiLcpqFYkgsop.svg" /></a> -->
<!-- Play on the blog -->
<script src="https://asciinema.org/a/flwFZOaUnv6UtiLcpqFYkgsop.js" id="asciicast-flwFZOaUnv6UtiLcpqFYkgsop" async></script>
<h4 id="imacro"><code>imacro</code></h4>
<p>An <code>imacro</code> actually imagines the
implementation of a function.</p>
<p>Components of the <code>imacro</code> should be inferred.
An <code>imacro</code> with only a function name should
work.</p>
<p>Also, an <code>imacro</code> is under the hood a regular
macro. This means, that expanding the <code>imacro</code>
will infer/generate underlying code.</p>
<figure>
    <img src="/ox-hugo/macro-expand-codex.gif"/> 
</figure>

<dl>
<dt><code>pf-imagine-an-emacs-function/3</code></dt>
<dd><a href="http://github.com/semiosis/prompts/blob/master/prompts/imagine-an-emacs-function-3.prompt">http://github.com/semiosis/prompts/blob/master/prompts/imagine-an-emacs-function-3.prompt</a></dd>
</dl>
<!--listend-->
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">title</span>: <span style="color:#ae81ff">imagine an emacs function</span>
<span style="color:#f92672">task</span>: <span style="color:#e6db74">&#34;imagine an emacs lisp function given name, arguments and docstring&#34;</span>
<span style="color:#f92672">doc</span>: <span style="color:#e6db74">&#34;Given a function name, arguments and docstring, return the imagined body of the function&#34;</span>
<span style="color:#f92672">prompt-version</span>: <span style="color:#ae81ff">1</span>
<span style="color:#f92672">prompt</span>: |+<span style="color:#e6db74">
</span><span style="color:#e6db74">  ;;my-emacs-library.el
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">  (defun &lt;name&gt; (&lt;arguments&gt;)
</span><span style="color:#e6db74">    &#34;&lt;docstring&gt;&#34;</span>  
<span style="color:#f92672">engine</span>: <span style="color:#e6db74">&#34;OpenAI Codex&#34;</span>
<span style="color:#f92672">temperature</span>: <span style="color:#ae81ff">0.2</span>
<span style="color:#f92672">max-generated-tokens</span>: <span style="color:#ae81ff">1000</span>
<span style="color:#f92672">top-p</span>: <span style="color:#ae81ff">1.0</span>
<span style="color:#f92672">cache</span>: <span style="color:#66d9ef">on</span>
<span style="color:#f92672">stop-sequences</span>:
- <span style="color:#e6db74">&#34;\n\n&#34;</span>
<span style="color:#f92672">vars</span>:
- <span style="color:#e6db74">&#34;name&#34;</span>
- <span style="color:#e6db74">&#34;arguments&#34;</span>
- <span style="color:#e6db74">&#34;docstring&#34;</span>
<span style="color:#f92672">validator</span>: <span style="color:#e6db74">&#34;chomp | sed -z &#39;s/.*\\(.\\)$/\\1/&#39; | grep -q &#39;)&#39;&#34;</span>
<span style="color:#f92672">examples</span>:
- <span style="color:#e6db74">&#34;times&#34;</span>
- <span style="color:#e6db74">&#34;x y&#34;</span>
- <span style="color:#e6db74">&#34;multiply two numbers and return a number&#34;</span>
<span style="color:#f92672">preprocessors</span>:
- <span style="color:#e6db74">&#34;slugify&#34;</span>
<span style="color:#f92672">postprocessor</span>: <span style="color:#ae81ff">chomp</span>
<span style="color:#f92672">postpostprocessor</span>: <span style="color:#e6db74">&#34;sed -z \&#34;s/^;;my-emacs-library.el\\\\n\\\\n//\&#34;&#34;</span>
<span style="color:#f92672">filter</span>: <span style="color:#66d9ef">on</span>
<span style="color:#f92672">completion</span>: <span style="color:#66d9ef">off</span>
<span style="color:#f92672">insertion</span>: <span style="color:#66d9ef">off</span></code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(<span style="color:#a6e22e">car</span>
 (pen-single-generation
  (pf-imagine-an-emacs-function/3
   <span style="color:#e6db74">&#34;times&#34;</span>
   <span style="color:#e6db74">&#34;x y&#34;</span>
   <span style="color:#e6db74">&#34;multiply two numbers and return a number&#34;</span>
   :include-prompt <span style="color:#66d9ef">t</span>
   :no-select-result <span style="color:#66d9ef">t</span>)))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defun times (x y)
  <span style="color:#e6db74">&#34;multiply two numbers and return a number&#34;</span>
  (<span style="color:#a6e22e">*</span> x y))</code></pre></td></tr></table>
</div>
</div>
<p>There are 3 different versions of <code>imacro</code>
depending on how many arguments are supplied to
it.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defmacro imacro/3 (name args docstr)
  <span style="color:#e6db74">&#34;Does not evaluate. It merely generates code.&#34;</span>
  (let* ((argstr (<span style="color:#a6e22e">apply</span> <span style="color:#e6db74">&#39;cmd</span> (<span style="color:#a6e22e">mapcar</span> <span style="color:#e6db74">&#39;slugify</span> (<span style="color:#a6e22e">mapcar</span> <span style="color:#e6db74">&#39;str</span> args))))
         (bodystr
          (<span style="color:#a6e22e">car</span>
           (pen-single-generation
            (pf-imagine-an-emacs-function/3
             name
             argstr
             docstr
             :include-prompt <span style="color:#66d9ef">t</span>
             :no-select-result <span style="color:#66d9ef">t</span>))))
         (body (eval-string (<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34;&#39;&#34;</span> bodystr))))
    <span style="color:#f92672">`</span>(progn <span style="color:#f92672">,</span>body)))

(defmacro imacro/2 (name args)
  <span style="color:#e6db74">&#34;Does not evaluate. It merely generates code.&#34;</span>
  (let* ((argstr (<span style="color:#a6e22e">apply</span> <span style="color:#e6db74">&#39;cmd</span> (<span style="color:#a6e22e">mapcar</span> <span style="color:#e6db74">&#39;slugify</span> (<span style="color:#a6e22e">mapcar</span> <span style="color:#e6db74">&#39;str</span> args))))
         (bodystr
          (<span style="color:#a6e22e">car</span>
           (pen-single-generation
            (pf-imagine-an-emacs-function/2
             name
             argstr
             :include-prompt <span style="color:#66d9ef">t</span>
             :no-select-result <span style="color:#66d9ef">t</span>))))
         (body (eval-string (<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34;&#39;&#34;</span> bodystr))))
    <span style="color:#f92672">`</span>(progn <span style="color:#f92672">,</span>body)))

(defmacro imacro/1 (name)
  <span style="color:#e6db74">&#34;Does not evaluate. It merely generates code.&#34;</span>
  (let* ((bodystr
          (<span style="color:#a6e22e">car</span>
           (pen-single-generation
            (pf-imagine-an-emacs-function/1
             name
             :include-prompt <span style="color:#66d9ef">t</span>
             :no-select-result <span style="color:#66d9ef">t</span>))))
         (body (eval-string (<span style="color:#a6e22e">concat</span> <span style="color:#e6db74">&#34;&#39;&#34;</span> bodystr))))
    <span style="color:#f92672">`</span>(progn <span style="color:#f92672">,</span>body)))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(imacro/3 my/itimes (a b c) <span style="color:#e6db74">&#34;multiply three complex numbers&#34;</span>)</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(progn
  (defun my-times
      (x y z)
    <span style="color:#e6db74">&#34;multiply three numbers and return a number&#34;</span>
    (<span style="color:#a6e22e">*</span> x y z)))</code></pre></td></tr></table>
</div>
</div>
<p><em><code>imacro</code> expansion demo</em></p>
<!-- Play on asciinema.com -->
<!-- <a title="asciinema recording" href="https://asciinema.org/a/TFjZGxMf0zhT59T7U3tO8uwY5" target="_blank"><img alt="asciinema recording" src="https://asciinema.org/a/TFjZGxMf0zhT59T7U3tO8uwY5.svg" /></a> -->
<!-- Play on the blog -->
<script src="https://asciinema.org/a/TFjZGxMf0zhT59T7U3tO8uwY5.js" id="asciicast-TFjZGxMf0zhT59T7U3tO8uwY5" async></script>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(imacro/2 my/subtract (a b c))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(progn
  (defun my-subtract
      (a b c)
    <span style="color:#e6db74">&#34;Subtract B from A and return the result.&#34;</span>
    (setq result
          (<span style="color:#a6e22e">+</span> a
             (<span style="color:#a6e22e">-</span> b c)))
    result))</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(imacro/1 my/subtract)</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(progn
  (defun my-subtract
      (a b)
    <span style="color:#e6db74">&#34;Subtract A - B.&#34;</span>
    (<span style="color:#a6e22e">-</span> a b)))</code></pre></td></tr></table>
</div>
</div>
<p><code>defimacro</code></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defmacro defimacro (name <span style="color:#66d9ef">&amp;rest</span> body)
  <span style="color:#e6db74">&#34;Define imacro&#34;</span>
  (cond
   ((<span style="color:#a6e22e">=</span> <span style="color:#ae81ff">0</span> (<span style="color:#a6e22e">length</span> body))
    <span style="color:#f92672">`</span>(imacro/1
      <span style="color:#f92672">,</span>name))
   ((<span style="color:#a6e22e">=</span> <span style="color:#ae81ff">1</span> (<span style="color:#a6e22e">length</span> body))
    <span style="color:#f92672">`</span>(imacro/2
      <span style="color:#f92672">,</span>name
      <span style="color:#f92672">,</span>(<span style="color:#a6e22e">car</span> body)))
   ((<span style="color:#a6e22e">=</span> <span style="color:#ae81ff">2</span> (<span style="color:#a6e22e">length</span> body))
    <span style="color:#f92672">`</span>(imacro/3
      <span style="color:#f92672">,</span>name
      <span style="color:#f92672">,</span>(<span style="color:#a6e22e">car</span> body)
      <span style="color:#f92672">,</span>(cadr body)))))</code></pre></td></tr></table>
</div>
</div>
<p>All of the following are valid ways to invoke <code>defimacro</code>.</p>
<p><code>defimacro</code> selects the right <code>imacro/N</code> function depending on the arity of the arguments.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defimacro my/subtract)
(defimacro my/subtract (a b c))
(defimacro my/itimes (a b c)
   <span style="color:#e6db74">&#34;multiply three complex numbers&#34;</span>)</code></pre></td></tr></table>
</div>
</div>
<!-- Play on asciinema.com -->
<!-- <a title="asciinema recording" href="https://asciinema.org/a/19czBa4Qyncgtg1JFi5JQLmfi" target="_blank"><img alt="asciinema recording" src="https://asciinema.org/a/19czBa4Qyncgtg1JFi5JQLmfi.svg" /></a> -->
<!-- Play on the blog -->
<script src="https://asciinema.org/a/19czBa4Qyncgtg1JFi5JQLmfi.js" id="asciicast-19czBa4Qyncgtg1JFi5JQLmfi" async></script>
<h4 id="ilist"><code>ilist</code></h4>
<p>The easiest of the list of syntax forms I
aimed to implement, <code>ilist</code> simply takes a the
number of items to generate (<code>n</code>) and a string
describing the type of thing to generate
(<code>type-of-thing</code>). It will return a real list
of such things.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defun ilist (n type-of-thing)
  (interactive (<span style="color:#a6e22e">list</span> (read-string-hist <span style="color:#e6db74">&#34;ilist n: &#34;</span>)
                     (read-string-hist <span style="color:#e6db74">&#34;ilist type-of-thing: &#34;</span>)))
  (pen-single-generation (pf-list-of/2 (str n) (str type-of-thing) :no-select-result <span style="color:#66d9ef">t</span>)))

(defun test-ilist ()
  (interactive)
  (etv (pps (ilist <span style="color:#ae81ff">10</span> <span style="color:#e6db74">&#34;tennis players&#34;</span>))))</code></pre></td></tr></table>
</div>
</div>
<h4 id="ifilter"><code>ifilter</code></h4>
<p>Example:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(pps (ifilter (ilist <span style="color:#ae81ff">10</span> <span style="color:#e6db74">&#34;tennis players&#34;</span>) <span style="color:#e6db74">&#34;is male&#34;</span>))</code></pre></td></tr></table>
</div>
</div>
<h4 id="derived-functions">Derived functions</h4>
<ul>
<li><em>get-backstory</em></li>
</ul>
<h4 id="iparse"><code>iparse</code></h4>
<h4 id="itransform"><code>itransform</code></h4>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(defun get-backstory ()

  )
(itransform)</code></pre></td></tr></table>
</div>
</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-emacs-lisp" data-lang="emacs-lisp">(pps (<span style="color:#a6e22e">mapcar</span> <span style="color:#e6db74">&#39;get-backstory</span> (ilist <span style="color:#ae81ff">10</span> <span style="color:#e6db74">&#34;tennis players&#34;</span>))</code></pre></td></tr></table>
</div>
</div>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
  		</div>
    </main>

            </div>

            
                <footer class="footer">

    <div class="footer__inner">
        <div class="footer__content">
            
            <span>Visit <a href="https://github.com/semiosis"><image src="/New_Zealand_Simplified.svg" style="display:inline-block; line-height:2em; vertical-align:middle; height: 2em;" /> semiosis on GitHub</a></span>

          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.2ce64ea6ea44a72b13dd812fc2eb5cca3efe878cce258a47c137c17edf46e0602a05e422b618a5b80b5939c731b7a293351c2f2222a21f6ee27e54a8448dd20e.js" integrity="sha512-LOZOpupEpysT3YEvwutcyj7&#43;h4zOJYpHwTfBft9G4GAqBeQithiluAtZOccxt6KTNRwvIiKiH27iflSoRI3SDg=="></script>



    </body>
</html>
